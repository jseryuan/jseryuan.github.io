<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		html,body{
			width: 100%;
			height: 100%;
			background: #000;
		}

	</style>
	<script>
		function rnd(m,n){
			return parseInt(Math.random()*(n-m)+m);
		}
		window.onload=function(){
			var oC=document.getElementById('c1');
			oC.width=document.documentElement.clientWidth;
			oC.height=document.documentElement.clientHeight;
			var gd=oC.getContext('2d');
			var aPoint=[];
			var N=5;
			var pw=1;
			var ph=1;
			var LEN=100;
			var oldArr=[];

			for(var i=0; i<N;i++){
				aPoint[i]={
					x:rnd(0,oC.width),
					y:rnd(0,oC.height),
					iSpeedX:rnd(-10,10),
					iSpeedY:rnd(-10,10)
				};
			}

			function drawPoint(p){
				gd.fillStyle='#fff';
				gd.fillRect(p.x-pw/2,p.y-ph/2,pw,ph);
			};

			setInterval(function(){
				gd.clearRect(0,0,oC.width,oC.height);
				for(var i=0;i<aPoint.length;i++){
					aPoint[i].x+=aPoint[i].iSpeedX;
					aPoint[i].y+=aPoint[i].iSpeedY;
					if(aPoint[i].x<0){
						aPoint[i].x=0;
						aPoint[i].iSpeedX*=-1;
					}
					if(aPoint[i].x>oC.width){
						aPoint[i].x=oC.width;
						aPoint[i].iSpeedX*=-1;
					}
					if(aPoint[i].y<0){
						aPoint[i].y=0;
						aPoint[i].iSpeedY*=-1;
					}
					if(aPoint[i].y>oC.height){
						aPoint[i].y=oC.height;
						aPoint[i].iSpeedY*=-1;
					}
                    drawPoint(aPoint[i]);
				}

				//连成线
				gd.beginPath();
				gd.moveTo(aPoint[0].x,aPoint[0].y);
				for(var i=1;i<aPoint.length;i++){
					gd.lineTo(aPoint[i].x,aPoint[i].y);
				}
				gd.closePath();
				gd.strokeStyle='#fff';
				gd.stroke();


				//加尾巴
				var arr=[];
				for(var i=0;i<aPoint.length;i++){
					arr[i]={
						x:aPoint[i].x,
						y:aPoint[i].y
					};
				}

				oldArr.push(arr);
				if(oldArr.length>LEN){
					oldArr.shift();
				}

				for(var i=0;i<oldArr.length;i++){
					gd.beginPath();
					gd.moveTo(oldArr[i][0].x,oldArr[i][0].y);
					for(var j=1;j<oldArr[i].length;j++){
						gd.lineTo(oldArr[i][j].x,oldArr[i][j].y);
					}
					gd.closePath();
					gd.strokeStyle='rgba(255,255,255,'+i/LEN+')';
					gd.stroke();
				}
			},16);
		};
	</script>
</head>
<body>
	<canvas id="c1"></canvas>
</body>
</html>